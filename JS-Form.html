<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=1, initial-scale=1.0" />
        <link rel="icon" type="image/png" sizes="32x32" href=" data:image/png;base64,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" />
        <title>JS Form</title>
        <style>
            /* @font-face {
      font-family: 'virtuous-slab';
      src: url('css/fonts/PublicSans-Light.woff2') format('woff2');

       border #444c56


      } */
            @import url('https://fonts.googleapis.com/css2?family=Public+Sans:wght@300&display=swap');

            :root {
                --BodyBackground: whitesmoke;
                --FieldsetLegend: black;
                --FieldsetBorder: black;
                --FieldsetShadow: black;
                --FieldsetBackground: whitesmoke;
                --LabelLarge: black;
                --LabelTop: dimgrey;
                --LabelTopBackground: whitesmoke;
                --LabelBorderActive: black;
                --LabelShadowActive: dimgrey;
                --InputText: black;
                --InputBackground: whitesmoke;
                --InputBorder: black;
                --InputShadow: black;
                --InputShadowHover: dimgrey;
                --InputShadowFocus: dimgrey;
                --ListBoxBackground: whitesmoke;
                --ScrollbarBackground: whitesmoke;
                --ScrollbaThumb: dimgrey;
                --ScrollbarCorner: blue;
                --ListBoxLiChecked: darkgrey;
                --ListBoxLiHover: lightgrey;
                --CheckboxCheckedBackground: whitesmoke;
                --CheckboxCheckedShadow: dimgrey;
                --CheckboxCheckedInside: black;
            }
            [data-theme='dark'] {
                --BodyBackground: #22272e;
                --FieldsetLegend: #adbac7;
                --FieldsetBorder: black;
                --FieldsetShadow: black;
                --FieldsetBackground: #1c2128;
                --LabelLarge: #768390;
                --LabelTop: #768390;
                --LabelTopBackground: transparent;
                --LabelBorderActive: #444c56;
                --LabelShadowActive: black;
                --InputText: #adbac7;
                --InputBackground: #22272e;
                --InputBorder: #444c56;
                --InputBorder: black;
                --InputShadow: black;
                --InputShadowHover: black;
                --InputShadowFocus: black;
                --ListBoxBackground: #22272e;
                --ScrollbarBackground: #22272e;
                --ScrollbaThumb: #768390;
                --ListBoxLiChecked: #1c2128;
                --ListBoxLiHover: #1c2128;
                --CheckboxCheckedBackground: #22272e;
                --CheckboxCheckedShadow: black;
                --CheckboxCheckedInside: black;
            }

            * {
                box-sizing: border-box;
            }
            body {
                position: relative;
                background: var(--BodyBackground);
                margin: 2rem auto;
                max-width: max-content;
                padding: 1em;
                margin: 2em auto;
            }
            #FORMVALUES {
                opacity: 0;
                -webkit-transition: 1.4s;
                transition: opacity 0.3s linear;
            }
            #FORMVALUES fieldset {
                font-family: 'Public Sans', sans-serif;
                padding: 0em 1em;
                margin: 20px;
                max-width: max-content;
                background: var(--FieldsetBackground);
                border: 1px solid var(--FieldsetBorder);
                box-shadow: 4px 4px 0 var(--FieldsetShadow);
                -webkit-transition: 1.4s;
                transition: opacity 0.3s linear;
            }
            pre {
                font-family: 'JetBrains Mono', monospace;
                font-size: 1em;
                line-height: 2em;
                color: #333;
            }
            fieldset.floatLabel {
                padding: 1.5rem;
                margin: 1em;
                background: #fff;
                width: 30rem;
                background: var(--FieldsetBackground);
                border: 1px solid var(--FieldsetBorder);
                box-shadow: 4px 4px 0 var(--FieldsetShadow);
            }
            .floatLabel legend {
                position: relative;
                /* top: -0.25em; */
                color: var(--FieldsetLegend);
                font-family: 'Public Sans', sans-serif;
                font-size: 1.5em;
            }
            .inputGroup {
                display: flex !important;
                margin-bottom: 0em !important;
            }
            .inputGroup div {
                margin-top: 0;
            }
            .inputGroup div:not(:last-child) {
                margin-right: 1.5em;
            }
            .floatLabel {
                font-size: 16px !important;
                font-family: 'Public Sans', sans-serif !important;
            }
            .floatLabel .inputGroup,
            .floatLabel .InputElement,
            .floatLabel .TextareaElement,
            .floatLabel .ListBox {
                display: block;
                width: 100%;
                /* height:1.9em; */
                position: relative;
                margin-bottom: 1.5em;
            }
            .floatLabel label:not(li label) {
                position: absolute;
                left: 0;
                top: 0.04em;
                padding: 0.3em 0.5em 0.25em 0.5em;
                pointer-events: none;
                cursor: text;
                font-size: 1em;
                color: var(--LabelLarge);
                -webkit-transition: 0.2s;
                transition: 0.2s;
            }
            .floatLabel .isActive label,
            .floatLabel label.isTop {
                top: -1em;
                left: 0.5em;
                padding: 0.1em 0.1em;
                background: var(--LabelTopBackground);
                color: var(--LabelTop);
                font-size: 0.8em;
                z-index: 2;
                -webkit-transition: 0.2s;
                transition: 0.2s;
            }
            .floatLabel input[type='text']::placeholder,
            .floatLabel input[type='select']::placeholder,
            .floatLabel textarea::placeholder {
                opacity: 0;
                -webkit-transition: 0.4s;
                transition: 0.2s;
            }
            .floatLabel .isActive input::placeholder,
            .floatLabel .isActive textarea::placeholder {
                opacity: 0.5;
                -webkit-transition: 0.4s;
                transition: 0.4s;
            }
            .floatLabelButton,
            .floatLabel input[type='text'],
            .floatLabel input[type='select'],
            .floatLabel textarea {
                font-size: 1em;
                line-height: 1.3em;
                /* padding: 0.25em 0.5em; */
                /* padding: 0.4em 0.5em 0.1em 0.5em; */
                padding: 0.35em 0.5em 0.2em 0.5em;
                border: 0;
                color: var(--InputText);
                background: var(--InputBackground);
                width: 100%;
                outline: var(--InputBorder) solid 1px;
                box-shadow: 4px 4px 0 var(--InputShadow);
                -webkit-transition: 0.1s;
                transition: 0.1s;
            }
            .floatLabel textarea:placeholder-shown {
                height: 1.8em;
                -webkit-transition: 0.2s;
                transition: 0.2s;
            }
            .floatLabel textarea,
            .floatLabel textarea:focus {
                height: 15em;
                -webkit-transition: 0.3s;
                transition: 0.3s;
                /* substract the outlines for the same height as input fields, just for CHROME & co */
                -webkit-margin-after: -4px;
            }
            .floatLabelButton {
                line-height: 1em !important;
                width: 45% !important;
                padding: 0.35em 0.5em 0.35em !important;
                cursor: pointer;
            }
            .floatLabel select:hover,
            .floatLabel input[type='text']:hover,
            .floatLabel input[type='select']:hover,
            .floatLabel textarea:hover,
            .floatLabelButton:hover {
                box-shadow: 4px 4px 0 var(--InputShadowHover);
                -webkit-transition: 0.1s;
                transition: 0.1s;
            }
            .floatLabel select:focus,
            .floatLabel input[type='text']:focus,
            .floatLabel .isActive input,
            .floatLabel textarea:focus,
            .floatLabelButton.submitButtonActive {
                box-shadow: 2px 2px 0 var(--InputShadowFocus) !important;
                transform: translate(2px, 2px);
                -webkit-transition: 0.1s;
                transition: 0.1s;
            }
            .floatLabel .ListBox ul {
                position: absolute;
                max-height: 0px;
                overflow: hidden;
                background: var(--ListBoxBackground);
                width: 100%;
                list-style: none;
                padding: 0;
                z-index: 5;

                margin: 0;
                -webkit-transition: 0.3s;
                transition: 0.3s;
            }
            .floatLabel .ListBox.isActive ul {
                max-height: 100px;
                left: 2px;
                /* FF */
                top: calc(2em + 2px);
                /* Chrome */
                top: 2em;
                overflow-y: scroll;
                overflow-x: hidden;
                scrollbar-width: thin;
                z-index: 5;
                outline: #000 solid 1px;
                box-shadow: 2px 2px 0 var(--LabelShadowActive), -1px -1px 0px 0px var(--LabelBorderActive);
                -webkit-transition: 0.3s;
                transition: 0.3s;
            }

            .floatLabel .ListBox.isActive ul::-webkit-scrollbar {
                height: 0px;
                width: 5px;
                background: var(--ScrollbarBackground);
            }
            .floatLabel .ListBox.isActive ul::-webkit-scrollbar-thumb {
                background: var(--ScrollbaThumb);
                /* -webkit-box-shadow: 0px 1px 2px #555; */
            }
            .floatLabel .ListBox.isActive ul::-webkit-scrollbar-corner {
                background: var(--ScrollbarCorner);
            }
            .floatLabel .ListBox li input:checked ~ label {
                background: var(--ListBoxLiChecked);
            }
            .floatLabel .ListBox li input:checked ~ label:hover,
            .floatLabel .ListBox li label:hover {
                background: var(--ListBoxLiHover);
                cursor: pointer;
            }
            .floatLabel .ListBox li label {
                display: inline-block;
                padding: 0.25em 0.5em;
                line-height: 1em;
                font-size: 0.85em;
                width: 100%;
                color: var(--LabelLarge);
            }
            .floatLabel .InputCheckbox label {
                position: relative;
                left: 0;
                top: 0;
                padding: 0.3em 0.5em 0.25em 0.25em;
                pointer-events: initial;
                cursor: pointer;
                font-size: 1em;
                color: var(--LabelLarge);
                -webkit-transition: 0.2s;
                transition: 0.2s;
            }
            .floatLabel .InputCheckbox {
                position: relative;
                width: 100%;
                height: 1.9em;
                margin-bottom: 0.5em;
                margin-top: -0.5em;
            }

            .floatLabel .InputCheckbox [type='checkbox'] {
                position: relative;
                left: 15px;
                top: -4px;
                z-index: 0;
                -webkit-appearance: none;
            }
            .floatLabel .InputCheckbox [type='checkbox'] + label {
                position: absolute;
                z-index: 5;
            }
            .floatLabel .InputCheckbox [type='checkbox'] + label:before {
                width: 12px;
                height: 12px;
                border-radius: 0px;
                border: 1px solid var(--InputBorder);
                background-color: var(--InputBackground);
                box-shadow: 2px 2px 0 var(--InputShadow);
                display: block;
                content: '';
                float: left;
                margin-right: 5px;
                z-index: 5;
                position: relative;
            }
            .floatLabel .InputCheckbox [type='checkbox']:checked + label:before {
                margin: 1px 4px 0 1px;
                box-shadow: inset 0px 0px 0px 2px var(--CheckboxCheckedBackground), 1px 1px 0 var(--CheckboxCheckedShadow);
                background-color: var(--CheckboxCheckedInside);
            }
        </style>
    </head>
    <body class="center"> 
            <label style="position:absolute; top:10px; right:20px;" for="darkmodecheckbox">
                <input type="checkbox" id="darkmodecheckbox" style="display:none"/>
                <em>Enable Dark Mode</em>
            </label> 
        <script>
            const toggleSwitch = document.getElementById('darkmodecheckbox');
            function switchTheme(e) {
                if (e.target.checked) {
                    document.documentElement.setAttribute('data-theme', 'dark');
                } else {
                    document.documentElement.setAttribute('data-theme', 'light');
                }
            }

            toggleSwitch.addEventListener('change', switchTheme, false);
        </script>
        <div id="FORM"></div>
        <div id="FORMVALUES" style="opacity: 0"></div>
        <script id="CREATEFORM">
            const deb = console.log.bind(window.console);
            //let FORM = document.getElementById("FORM");

            // Create a break line element
            // let br = document.createElement('br');
            function createForm(json) {
                //
                // make obj handles
                let data = json.FormData;
                let meta = json.FormMeta;
                //
                // create the form
                let form = document.createElement('form');
                form.setAttribute('method', meta.method);
                form.setAttribute('action', meta.action);
                form.setAttribute('name', meta.name);
                form.setAttribute('autocomplete', 'off');

                //
                // loops for every form item
                data.forEach((d) => {
                    // TEXT INPUT
                    if ('text' === d.type) {
                        form.appendChild(createInputText(d));
                    }
                    // TEXTAREA
                    if ('textarea' === d.type) {
                        form.appendChild(createTextarea(d));
                    }

                    // checkboxGroup
                    // let divChk = document.createElement('div');
                    // divChk.setAttribute('class', 'checkboxGroup');
                    // if ('checkboxGroup' === d.type) {
                    //     d.items.forEach((i) => {
                    //         divChk.appendChild(createcheckboxGroup(i));
                    //     });
                    //     form.appendChild(divChk);
                    // }

                    // SELECT
                    if ('select' === d.type) {
                        form.appendChild(createListBox(d));
                    }

                    // INPUTGROUP
                    if ('inputGroup' === d.type) {
                        //
                        // SOURROUNDING DIV
                        let divGroup = document.createElement('div');
                        divGroup.setAttribute('class', 'inputGroup');

                        d.items.forEach((i) => {
                            i.GroupName = d.name;
                            if ('text' === i.type) {
                                divGroup.appendChild(createInputText(i));
                            }
                            if ('checkbox' === i.type) {
                                divGroup.appendChild(createInputCheckbox(i));
                            }
                        });

                        form.appendChild(divGroup);
                    }
                });

                //
                // CREATE LISTBOX
                //
                function createListBox(d) {
                    // SOURROUNDING DIV
                    let div = document.createElement('div');
                    div.setAttribute('class', 'ListBox');
                    // INPUT FIELD
                    let input = document.createElement('input');
                    input.setAttribute('type', d.type);
                    input.setAttribute('name', d.name);
                    input.setAttribute('class', 'ListBoxInput');
                    input.setAttribute('onclick', 'openListBox(this)');
                    input.setAttribute('placeholder', d.placeholder);
                    // input.setAttribute('value', d.placeholder);
                    // LABEL
                    let label = document.createElement('label');
                    label.textContent = d.titel;
                    // LIST
                    let ul = document.createElement('ul');
                    d.items.forEach((i) => {
                        // deb(i)
                        let li = document.createElement('li');
                        // LABEL
                        let ItemLabel = document.createElement('label');
                        ItemLabel.textContent = i.name;
                        ItemLabel.setAttribute('class', 'ListBoxItem');
                        ItemLabel.setAttribute('for', i.value);
                        // ItemLabel.setAttribute('onclick', 'addListBoxItem(this)');

                        // CHECKBOX
                        let ckbox = document.createElement('input');
                        ckbox.setAttribute('type', 'checkbox');
                        ckbox.setAttribute('name', i.name);
                        ckbox.setAttribute('id', i.value);
                        ckbox.setAttribute('class', 'ListBoxItem');
                        ckbox.setAttribute('style', 'display:none');
                        ckbox.setAttribute('onclick', 'addListBoxItem(this)');

                        // CONCAT LISTITEMS
                        li.appendChild(ckbox);
                        li.appendChild(ItemLabel);
                        ul.appendChild(li);
                    });

                    // CONCAT EVERYTHING
                    div.appendChild(label);
                    div.appendChild(input);
                    div.appendChild(ul);
                    return div;
                }

                //
                // CREATE CHECKBOXGROUP
                //
                // function createcheckboxGroup(d) {
                //     // SOURROUNDING DIV
                //     let div = document.createElement('div');
                //     div.setAttribute('class', 'CheckboxElement');
                //     // INPUT FIELD
                //     let input = document.createElement('input');
                //     input.setAttribute('type', 'checkbox');
                //     input.setAttribute('name', d.name);
                //     // LABEL
                //     let label = document.createElement('label');
                //     label.textContent = d.name;
                //     // CONCAT EVERYTHING
                //     div.appendChild(input);
                //     div.appendChild(label);
                //     return div;
                // }

                //
                // CREATE INPUT TEXT
                //
                function createInputText(d) {
                    // SOURROUNDING DIV
                    let div = document.createElement('div');
                    div.setAttribute('class', 'InputElement');
                    // INPUT FIELD
                    let input = document.createElement('input');
                    input.setAttribute('type', d.type);
                    input.setAttribute('name', d.name);
                    input.setAttribute('placeholder', d.placeholder);
                    input.setAttribute('onclick', 'activateInput(this)');
                    // input.setAttribute('value', d.placeholder);
                    // LABEL
                    let label = document.createElement('label');
                    label.textContent = d.titel;
                    // CONCAT EVERYTHING
                    div.appendChild(label);
                    div.appendChild(input);
                    return div;
                }

                //
                // CREATE INPUT CHECKBOX
                //
                function createInputCheckbox(d) {
                    deb(d);
                    // SOURROUNDING DIV
                    let div = document.createElement('div');
                    div.setAttribute('class', 'InputCheckbox');
                    // SPAN FOR NEW CHECKBOX
                    let span = document.createElement('span');
                    span.setAttribute('class', 'CustomCheckbox');
                    // INPUT FIELD
                    let input = document.createElement('input');
                    input.setAttribute('type', d.type);
                    input.setAttribute('value', d.value);
                    input.setAttribute('name', d.GroupName + '[]');
                    input.setAttribute('id', 'ckb' + d.titel);
                    //   input.setAttribute("style", "display:none;");
                    // LABEL
                    let label = document.createElement('label');
                    label.setAttribute('class', 'ckbLabel');
                    label.setAttribute('for', 'ckb' + d.titel);

                    label.textContent = d.titel;
                    // CONCAT EVERYTHING
                    div.appendChild(input);
                    // div.appendChild(span);
                    div.appendChild(label);
                    return div;
                }

                //
                // CREATE TEXTAREA
                //
                function createTextarea(d) {
                    //
                    // SOURROUNDING DIV
                    let div = document.createElement('div');
                    div.setAttribute('class', 'TextareaElement');

                    //
                    // INPUT FIELD
                    let input = document.createElement('textarea');
                    input.setAttribute('type', d.type);
                    input.setAttribute('name', d.name);
                    input.setAttribute('placeholder', d.placeholder);
                    input.setAttribute('onclick', 'activateInput(this)');
                    // input.setAttribute('value', d.placeholder);

                    //
                    // LABEL
                    let label = document.createElement('label');
                    label.textContent = d.titel;
                    // label.setAttribute('class', 'LabelTop');

                    //
                    // CONCAT EVERYTHING
                    div.appendChild(label);
                    div.appendChild(input);
                    return div;
                }

                //
                // SUBMIT BUTTON
                let submit = document.createElement('input');
                submit.setAttribute('type', 'submit');
                submit.setAttribute('value', 'Submit');
                submit.setAttribute('id', 'submitButton');
                submit.setAttribute('class', 'floatLabelButton');
                form.appendChild(submit);

                //
                // CREATE THE FULL FORMFIELD

                // FIELDSET
                let fieldset = document.createElement('fieldset');
                fieldset.setAttribute('class', 'floatLabel');
                // LEGEND
                let legend = document.createElement('legend');
                legend.innerText = meta.name;
                // CONCAT WITH FORM
                fieldset.appendChild(legend);
                fieldset.appendChild(form);
                // INSERT IN DOM
                document.getElementById(meta.ID).appendChild(fieldset);
            } // createForm
        </script>

        <script id="EVENTHANDLER">
            //
            // OPEN LISBOX
            //
            function openListBox(el) {
                el.parentNode.classList.add('isActive');
            }

            //
            // ACTIVATE INPUT
            //
            function activateInput(el) {
                el.parentNode.classList.add('isActive');
            }

            //
            // LISTBOXITEM TO INPUT
            //
            function addListBoxItem(el) {
                // get ckeckbox value, input element & lable
                let ckbValue = el.id;
                let InputValue = el.parentNode.parentNode.previousSibling.value;
                let InputLabel = el.parentNode.parentNode.previousSibling.previousSibling;
                // add (remove) value to input
                if (el.checked) {
                    el.parentNode.parentNode.previousSibling.value = InputValue + ckbValue + ', ';
                } else {
                    el.parentNode.parentNode.previousSibling.value = InputValue.replace(ckbValue + ', ', '');
                }
                var event = new Event('change');
                el.parentNode.parentNode.previousSibling.dispatchEvent(event);
                // set label on top if input ha a value and vice versa
                if (0 < el.parentNode.parentNode.previousSibling.value.length) {
                    InputLabel.setAttribute('class', 'isTop');
                } else {
                    InputLabel.removeAttribute('class', 'isTop');
                }
            }

            window.addEventListener('load', function () {
                //
                // EVENTLISTENER CLICK
                //
                document.addEventListener(
                    'click',
                    (evt) => {
                        let targetEl = evt.target;
                        // set input as notActive (remove isActive), lable down, shaddow move back, close ListBox
                        // loop up over elements and search for .isActive class,
                        // if not found, remove all .isActive from the document
                        do {
                            if (targetEl.classList !== undefined && targetEl.classList.contains('isActive')) {
                                return;
                            }
                            targetEl = targetEl.parentNode;
                        } while (targetEl);

                        document.querySelectorAll('.isActive').forEach((el) => {
                            el.classList.remove('isActive');
                        });
                    },
                    true
                );

                //
                // EVENTLISTENER CHANGE
                //
                const allInputs = document.querySelectorAll("input[type='text'],input[type='select'], textarea");
                allInputs.forEach(function (el) {
                    // deb(el)
                    // if (null === el.parentNode.parentNode.previousSibling) {
                    //     const labelListBox = el.previousSibling;
                    // } else {
                    //     const labelListBox = el.parentNode.parentNode.previousSibling;
                    // }
                    const labelListBox = el.parentNode.parentNode.previousSibling;
                    const label = el.previousSibling;
                    el.addEventListener(
                        'change',
                        (evt) => {
                            if (0 < el.value.length) {
                                if (null === labelListBox) {
                                    deb(el.previousSibling);
                                    // deb(el.parentNode.parentNode.previousSibling);
                                }
                                // labelListBox.setAttribute('class', 'isTop');
                                label.setAttribute('class', 'isTop');
                            } else {
                                // labelListBox.removeAttribute('class', 'isTop');
                                label.removeAttribute('class', 'isTop');
                            }
                        },
                        true
                    );
                });
            });

            window.addEventListener('load', function () {
                // //
                // // GET ITEMS OF LISTBOX UL
                // //
                // const ListBox = document.querySelectorAll('.ListBox ul');
                // // deb(ListBox)
                // // FOREACH LISTBOX
                // ListBox.forEach(function (ul) {
                //     const CKBBOX = ul.querySelectorAll('input');
                //     //   deb(CKBBOX)

                //     ul.addEventListener('click', (evt) => {
                //         let inputSelect = evt.target.parentNode.parentNode.previousSibling;
                //         deb('\n\n NEW CLICK');
                //         deb(evt.target);
                //         if ('ListBoxItem' === evt.target.getAttribute('class')) {
                //             // COLLECT ALL VALUES FROM CHECKED CHECKBOXES
                //             let InputItems = '';
                //             ul.childNodes.forEach(function (li) {
                //                 if (li.firstChild.checked) {
                //                     InputItems += li.firstChild.name + ', ';
                //                 }
                //             });
                //             if (InputItems) {
                //                 inputSelect.classList.add('inputFocus');
                //                 inputSelect.value = InputItems.replace(/,\s*$/, '');
                //             } else {
                //                 // IF INPUTITEMS IS EMPTY, REMOVE STRING FROM INPUT VALUE && AND SET FOCUS FOR PLACEHOLDER
                //                 inputSelect.focus();
                //                 inputSelect.value = null;
                //             }

                //             // IF CKICK IS OUTSINE OF LISTBOX
                //             // } else if (evt.target.querySelector('.ListBoxItem')) {
                //             // } else if ('showPlaceholder' !== evt.target.getAttribute('class')) {
                //         } else {
                //             // CLOSE LISTBOX
                //             // deb(evt.target.parentNode.parentNode);
                //             // evt.target.parentNode.parentNode.removeAttribute('class', 'LBopen');
                //             // inputSelect.setAttribute('class', 'LabelTop');

                //             // // MOVE BACK LISTBOX INPUT
                //             // inputSelect.removeAttribute('class', 'inputFocus');
                //         }
                //     });
                // });
                // document.addEventListener('click', (evt) => {
                //     deb(evt.target);

                //     if ('ListBoxItem' !== evt.target.getAttribute('class')) {
                //         const ListBox = document.querySelectorAll('.ListBox ul');
                //         ListBox.forEach(function (ul) {
                //             ul.removeAttribute('class', 'LBopen');
                //             ul.previousSibling.setAttribute('class', 'LabelTop');

                //             // MOVE BACK LISTBOX INPUT
                //             ul.previousSibling.removeAttribute('class', 'inputFocus');
                //         });

                //         deb('doc');
                //         deb(evt.target.getAttribute('class'));
                //     }
                // });

                // //
                // // EVENTS FOR ALL INPUT TEXT && TEXTAREAS
                // let FormElement = document.querySelectorAll("input[type='text'],input[type='select'], textarea");
                // FormElement.forEach(function (el) {
                //     // deb(el)
                //     //
                //     // IF FIELD HAS A PRESETTED VALUE
                //     if (el.value) {
                //         // AD CLASS TO LABLE TO LIFT IT UP
                //         //   el.previousSibling.setAttribute('class', 'LabelTop');
                //         // ADD CLASS TO SHOW PLACEHOLDER
                //         el.setAttribute('class', 'showPlaceholder');
                //     }

                //     // IF FIELD IS IN FOCUS
                //     el.addEventListener('focus', function () {
                //         // AD CLASS TO LABLE TO LIFT IT UP
                //         el.previousSibling.setAttribute('class', 'LabelTop');
                //         // ADD CLASS TO SHOW PLACEHOLDER
                //         el.setAttribute('class', 'showPlaceholder');
                //         //
                //         // DROPDOWN SELECT LIST
                //         if ('select' === el.attributes.type.nodeValue) {
                //             el.nextSibling.setAttribute('class', 'LBopen');
                //             //   el.classList.add('inputFocus');
                //             //   el.nextSibling.setAttribute('class', 'inputFocus');
                //             deb(el);
                //             // el.setAttribute('class', 'LabelTop');
                //         }
                //     }); // addEventListener(focus)

                //     //
                //     // IF FIELD IS NOT IN FOCUS
                //     el.addEventListener('blur', function () {
                //         if (!el.value) {
                //             //   deb("blur")
                //             // REMOVE CLASS FROM LABLE
                //             el.previousSibling.removeAttribute('class', 'LabelTop');
                //             // REMOVE CLASS TO HIDE PLACEHOLDER & SCHOW LABLE AGAIN
                //             // el.removeAttribute('class', 'showPlaceholder');
                //             el.classList.remove('showPlaceholder');
                //         }
                //         // DROPDOWN SELECT LIST
                //         if ('select' === el.attributes.type.nodeValue) {
                //             // el.nextSibling.removeAttribute('class', 'LBopen');
                //         }
                //     });
                //     // deb(el.attributes.type.nodeValue)
                // }); //ForEach FormElement

                //
                // SET SUBMIT BUTTON STATE
                document.getElementById('submitButton').addEventListener('mousedown', function () {
                    this.classList.add('submitButtonActive');
                    this.addEventListener('mouseup', function () {
                        this.classList.remove('submitButtonActive');
                    });
                });
            }); // window.load (EVENTHANDLER)
        </script>

        <script id="FORMSUBMIT">
            window.addEventListener('load', function () {
                function showData() {
                    let FormName = data.FormMeta.name;
                    let FormElements = document.forms[FormName].elements;
                    deb(FormElements);
                    FormValues = {};
                    for (let element of FormElements) {
                        if (element.value && element.name) {
                            // remove ListBox checkboxGroup
                            if ('ListBoxItem' === element.getAttribute('class')) {
                                continue;
                            }
                            if ('checkbox' === element.type) {
                                if (element.checked) {
                                    deb(element);
                                    if (!FormValues[element.name]) {
                                        FormValues[element.name] = [];
                                    }
                                    FormValues[element.name].push(element.value);
                                }
                            } else {
                                FormValues[element.name] = element.value;
                            }
                        }
                    }
                    // deb(FormValues)
                    let values = JSON.stringify(FormValues, undefined, 4);
                    values = values.replaceAll('{', '');
                    values = values.replaceAll('}', '');
                    values = values.replaceAll('"', '');
                    // values = values.replaceAll(',', '');
                    values = values.replaceAll('    ', '');
                    let FORMVALUES = document.getElementById('FORMVALUES');
                    FORMVALUES.innerHTML = "<fieldset><legend style='font-size: 1.4em'>Form Values</legend><pre>" + values + '</pre></fieldset>';
                    FORMVALUES.style.opacity = 1;
                }

                //
                // CLICKHANDLER for everything?
                document.addEventListener('click', (evt) => {
                    const LEGEND = document.querySelector('#FORMVALUES legend'); // DEV
                    const FORMVALUES = document.querySelector('#FORMVALUES'); // DEV

                    let targetElement = evt.target; // clicked element
                    do {
                        // REMOVE FORM VALUES (DEV)
                        if (targetElement == LEGEND) {
                            FORMVALUES.style.opacity = 0;
                            return;
                        }
                        // deb(targetElement);
                        targetElement = targetElement.parentNode;
                    } while (targetElement);
                    // deb('outside');
                });

                //
                // KEYHANDLER
                document.onkeydown = function (evt) {
                    evt = evt || window.event;
                    const FORMVALUES = document.querySelector('#FORMVALUES');
                    var isEscape = false;
                    if ('key' in evt) {
                        // deb(evt);
                        if (evt.key === 'Escape' || evt.key === 'Esc') {
                            FORMVALUES.style.opacity = 0;
                        }
                    }
                };

                // function sendData() {
                //     const XHR = new XMLHttpRequest();
                //     const FD = new FormData(form);
                //     XHR.addEventListener('load', function (event) {
                //         deb(event.target.responseText);
                //     });
                //     XHR.addEventListener('error', function (event) {
                //         deb('Oops! Something went wrong.');
                //     });
                //     XHR.open('POST', 'api.php');
                //     deb(form);
                //     XHR.send(FD);
                // }
                const form = document.getElementById('FORM');
                form.addEventListener('submit', function (event) {
                    event.preventDefault();
                    // sendData();
                    showData();
                });
            });
        </script>
        <script id="JSONDATA">
            const data = {
                FormMeta: {
                    name: 'Testform',
                    ID: 'FORM',
                    method: 'POST',
                    action: '',
                },
                FormData: [
                    {
                        type: 'inputGroup',
                        items: [
                            {
                                type: 'text',
                                name: 'firstname',
                                titel: 'Firstname',
                                placeholder: 'how are you called',
                            },
                            {
                                type: 'text',
                                name: 'surename',
                                titel: 'Surename',
                                placeholder: 'how are you called',
                            },
                        ],
                    },
                    {
                        type: 'inputGroup',
                        name: 'TOPs',
                        items: [
                            {
                                type: 'checkbox',
                                value: 'one',
                                titel: 'TOP I',
                            },
                            {
                                type: 'checkbox',
                                value: 'two',
                                titel: 'TOP II',
                            },
                            {
                                type: 'checkbox',
                                value: 'three',
                                titel: 'TOP III',
                            },
                            {
                                type: 'checkbox',
                                value: 'four',
                                titel: 'TOP IV',
                            },
                        ],
                    },
                    {
                        type: 'text',
                        name: 'email',
                        titel: 'E-Mail',
                        placeholder: 'please give us a way to contact you',
                    },
                    {
                        type: 'textarea',
                        name: 'comment',
                        titel: 'Comment (textarea)',
                        placeholder: 'No newsletter please...',
                    },
                    {
                        type: 'select',
                        name: 'dinosaurs',
                        titel: 'Dinosaurs (select)',
                        placeholder: 'choose your favorites, yes more than one!',
                        items: [
                            {
                                name: 'BrachiosaurusN',
                                value: 'BrachiosaurusV',
                            },
                            {
                                name: 'Iguanodon',
                                value: 'Iguanodon',
                            },
                            {
                                name: 'Dryosaurus',
                                value: 'Dryosaurus',
                            },
                            {
                                name: 'Tenontosaurus',
                                value: 'Tenontosaurus',
                            },
                            {
                                name: 'Argentinosaurus',
                                value: 'Argentinosaurus',
                            },
                            {
                                name: 'Brontosaurus',
                                value: 'Brontosaurus',
                            },
                            {
                                name: 'Tyrannosaurus',
                                value: 'Tyrannosaurus',
                            },
                        ],
                    },
                    {
                        type: 'select',
                        name: 'animals',
                        titel: 'Animals (select)',
                        placeholder: 'choose your favorites, yes more than one!',
                        items: [
                            {
                                name: 'African bush elephant',
                                value: 'Africanbushelephant',
                            },
                            {
                                name: 'Elephant shrew',
                                value: 'Elephant shrew',
                            },
                            {
                                name: 'Black rhinoceros',
                                value: 'Blackrhinoceros',
                            },
                            {
                                name: 'Rhino beetle',
                                value: 'Rhino beetle',
                            },
                            {
                                name: 'African buffalo',
                                value: 'African buffalo',
                            },
                            {
                                name: 'Buffalo weaver',
                                value: 'Buffalo weaver',
                            },
                            {
                                name: 'Lion',
                                value: 'Lion',
                            },
                            {
                                name: 'Antlion',
                                value: 'Antlion',
                            },
                            {
                                name: 'Leopard',
                                value: 'Leopard',
                            },
                            {
                                name: 'Leopard tortoise',
                                value: 'Leopard tortoise',
                            },
                        ],
                    },
                ],
            };
            // deb(data);
            createForm(data);
        </script>
    </body>
</html>
