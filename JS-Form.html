<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=1, initial-scale=1.0" />
        <link rel="icon" type="image/png" sizes="32x32" href=" data:image/png;base64,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" />
        <title>JS Form</title>
        <style>
            /* @font-face {
                font-family: 'virtuous-slab';
                src: url('css/fonts/PublicSans-Light.woff2') format('woff2');
            } */
            @import url('https://fonts.googleapis.com/css2?family=Public+Sans:wght@300&display=swap');
            * {
                box-sizing: border-box;
            }
            body {
                position: relative;
                background: #eee;
                margin: 2rem auto;
                max-width: max-content;
                padding: 1em;
                margin: 2em auto;
            }

            #FORMVALUES {
                opacity: 0;
                -webkit-transition: 1.4s;
                transition: opacity 0.3s linear;
            }

            #FORMVALUES fieldset {
                font-family: 'Public Sans', sans-serif;
                /* opacity: 0; */
                padding: 0em 1em;
                margin: 20px;
                max-width: max-content;
                background: #fff;
                border: 1px solid #000;
                box-shadow: 4px 4px 0 #555;
                -webkit-transition: 1.4s;
                /* transition: opacity 1.4s; */
                transition: opacity 0.3s linear;
            }
             
            pre {
                font-family: 'JetBrains Mono', monospace;
                font-size: 1em;
                line-height: 2em;
                color: #333;
            }
            fieldset.floatLabel {
                padding: 1.5rem;
                margin: 1em;
                background: #fff;
                width: 30rem;
                border: 1px solid #000;
                box-shadow: 4px 4px 0 #555;
            }
            .floatLabel legend {
                position: relative;
                top: -0.25em;
                font-family: 'Public Sans', sans-serif;
                font-size: 1.5em;
            }

            .inputGroup {
                display: flex !important;
                margin-bottom: 0em !important;
            }
            .inputGroup div {
                margin-top: 0;
            }
            .inputGroup div:not(:last-child) {
                margin-right: 15px;
            }

            .floatLabel {
                font-size: 18px !important;
            }

            .floatLabel div {
                display: block;
                width: 100%;
                position: relative;
                margin-bottom: 1.5em;
                font-family: 'Public Sans', sans-serif;
            }

            .floatLabel label {
                position: absolute;
                left: 0;
                top: 0.04em;
                padding: 0.25em 0.5em;

                pointer-events: none;
                cursor: text;
                font-size: 1em;
                color: #555;
                -webkit-transition: 0.2s;
                transition: 0.2s;
            }

            .floatLabel label.floated {
                top: -1em;
                left: 0.5em;
                padding: 0.1em 0.1em;
                background: white;
                font-size: 0.8em;
                z-index: 2;
                -webkit-transition: 0.2s;
                transition: 0.2s;
            }

            .floatLabel input::placeholder,
            .floatLabel textarea::placeholder {
                opacity: 0;
                -webkit-transition: 0.4s;
                transition: 0.2s;
            }

            .floatLabel input.visible::placeholder,
            .floatLabel textarea.visible::placeholder {
                opacity: 0.5;
                -webkit-transition: 0.4s;
                transition: 0.4s;
            }

            .floatLabelButton,
            .floatLabel input,
            .floatLabel textarea {
                font-size: 1em;
                line-height: 1.3em;
                padding: 0.25em 0.5em;
                border: 0;
                color: #000;
                background: #fff;
                width: 100%;
                outline: #000 solid 1px;
                box-shadow: 4px 4px 0 #555;
                -webkit-transition: 0.1s;
                transition: 0.1s;
            }

            .floatLabel textarea:placeholder-shown {
                height: 2.5em;
                -webkit-transition: 0.2s;
                transition: 0.2s;
            }
            .floatLabel textarea,
            .floatLabel textarea:focus {
                height: 15em;
                -webkit-transition: 0.3s;
                transition: 0.3s;
            }
            .floatLabelButton {
                line-height: 1em !important;
                width: 45% !important;
                padding: 0.35em 0.5em 0.35em !important;
                cursor: pointer;
            }
            .floatLabel select:hover,
            .floatLabel input:hover,
            .floatLabel textarea:hover,
            .floatLabelButton:hover {
                box-shadow: 4px 4px 0 #777;
                -webkit-transition: 0.1s;
                transition: 0.1s;
            }
            .floatLabel select:focus,
            .floatLabel input:not([type='submit']):focus,
            .floatLabel textarea:focus,
            .floatLabelButton.submitButtonActive {
                box-shadow: 2px 2px 0 #777 !important;
                transform: translate(2px, 2px);
                -webkit-transition: 0.1s;
                transition: 0.1s;
            }
        </style>
    </head>
    <body class="center">
        <div id="FORM"></div>
        <div id="FORMVALUES" style="opacity: 0"></div>


<fieldset class=floatLabel>
    <div id=SelectPreset>
    <input autocomplete="off" class=DropDownDataList role="combobox" list="" id="Preset" name="Presets" placeholder="Select Preset">
    <label>DropDown</label>
    <datalist id="Presets" class="DDDL_small" role="listbox">
        <option value='start'>start</option>
        <option value='create new repo'>create new repo</option>
        <option value='commit and push'>commit and push</option>
        <option value='info and stats'>info and stats</option>
        <option value='pull'>pull</option>
        <option value='all'>all</option>
    </datalist>
</div>
</fieldset>
 

    </div>
        <script id="CREATEFORM">
            //let FORM = document.getElementById("FORM");

            // Create a break line element
            let br = document.createElement('br');
            function createForm(json) {
                //
                // make obj handles
                let data = json.FormData;
                let meta = json.FormMeta;

                //
                // create the form
                let form = document.createElement('form');
                form.setAttribute('method', meta.method);
                form.setAttribute('action', meta.action);
                form.setAttribute('name', meta.name);

                //
                // loops for every form item
                data.forEach((d) => {
                    //
                    // TEXT INPUT
                    if ('text' === d.type) {
                        form.appendChild(createInputText(d));
                    }

                    //
                    // TEXTAREA
                    if ('textarea' === d.type) {
                        form.appendChild(createTextarea(d));
                    }

                    //
                    // INPUTGROUP
                    if ('inputGroup' === d.type) {
                        //
                        // SOURROUNDING DIV
                        let divGroup = document.createElement('div');
                        divGroup.setAttribute('class', 'inputGroup');

                        d.items.forEach((i) => {
                            if ('text' === i.type) {
                                divGroup.appendChild(createInputText(i));
                            }
                        });
                        form.appendChild(divGroup);
                    }
                });

                //
                // INPUT TEXT
                //
                function createInputText(d) {
                    //
                    // SOURROUNDING DIV
                    let div = document.createElement('div');
                    div.setAttribute('class', 'InputElement');

                    //
                    // INPUT FIELD
                    let input = document.createElement('input');
                    input.setAttribute('type', d.type);
                    input.setAttribute('name', d.name);
                    input.setAttribute('placeholder', d.placeholder);
                    input.setAttribute('value', d.placeholder);

                    //
                    // LABEL
                    let label = document.createElement('label');
                    label.textContent = d.titel;

                    // CONCAT EVERYTHING
                    div.appendChild(label);
                    div.appendChild(input);
                    return div;
                }

                //
                // TEXTAREA
                //
                function createTextarea(d) {
                    //
                    // SOURROUNDING DIV
                    let div = document.createElement('div');
                    div.setAttribute('class', 'TextareaElement');

                    //
                    // INPUT FIELD
                    let input = document.createElement('textarea');
                    input.setAttribute('type', d.type);
                    input.setAttribute('name', d.name);
                    input.setAttribute('placeholder', d.placeholder);
                    input.setAttribute('value', d.placeholder);

                    //
                    // LABEL
                    let label = document.createElement('label');
                    label.textContent = d.titel;
                    // label.setAttribute('class', 'floated');

                    //
                    // CONCAT EVERYTHING
                    div.appendChild(label);
                    div.appendChild(input);
                    return div;
                }

                //
                // SUBMIT BUTTON
                let submit = document.createElement('input');
                submit.setAttribute('type', 'submit');
                submit.setAttribute('value', 'Submit');
                submit.setAttribute('id', 'submitButton');
                submit.setAttribute('class', 'floatLabelButton');
                form.appendChild(submit);

                //
                // CREATE THE FULL FORMFIELD

                // FIELDSET
                let fieldset = document.createElement('fieldset');
                fieldset.setAttribute('class', 'floatLabel');
                // LEGEND
                let legend = document.createElement('legend');
                legend.innerText = meta.name;
                // CONCAT WITH FORM
                fieldset.appendChild(legend);
                fieldset.appendChild(form);
                // INSERT IN DOM
                document.getElementById(meta.ID).appendChild(fieldset);

                //
                // EVENTS FOR ALL INPUT TEXT && TEXTAREAS
                let inputText = document.querySelectorAll("input[type='text'], textarea");

                inputText.forEach(function (elem) {
                    // IF FIELD HAS A PRESETTED VALUE
                    if (elem.value) {
                        // AD CLASS TO LABLE TO LIFT IT UP
                        elem.previousSibling.setAttribute('class', 'floated');
                        // ADD CLASS TO SHOW PLACEHOLDER
                        elem.setAttribute('class', 'visible');
                    }

                    // IF FIELD IS IN FOCUS
                    elem.addEventListener('focus', function () {
                        // AD CLASS TO LABLE TO LIFT IT UP
                        elem.previousSibling.setAttribute('class', 'floated');
                        // ADD CLASS TO SHOW PLACEHOLDER
                        elem.setAttribute('class', 'visible');
                    });
                    // IF FIELD IS NOT IN FOCUS
                    elem.addEventListener('blur', function () {
                        if (!elem.value) {
                            // REMOVE CLASS FROM LABLE
                            elem.previousSibling.removeAttribute('class', 'floated');
                            // REMOVE CLASS TO HIDE PLACEHOLDER & SCHOW LABLE AGAIN
                            elem.removeAttribute('class', 'visible');
                        }
                    });
                });

                //
                // SET BUTTON STATE
                let submitButton = document.getElementById('submitButton');
                submitButton.addEventListener('mousedown', function () {
                    submitButton.classList.add('submitButtonActive');
                });
                submitButton.addEventListener('mouseup', function () {
                    submitButton.classList.remove('submitButtonActive');
                });
            } // createForm
        </script>

        <script>
            function DDDL() {
                // DATALIST
                // https: //dev.to/siddev/customise-datalist-45p0
                const DropDownDataLists = document.querySelectorAll('input.DropDownDataList');

                // console.log(DropDownDataLists);
                for (let i = 0; i < DropDownDataLists.length; i++) {
                    DropDownDataLists[i].addEventListener('click', function () {
                        var dddlInput = this;
                        var dddlInputName = dddlInput.name;
                        var dddlDatalist = document.getElementById(dddlInputName);

                        dddlDatalist.style.display = 'block';
                        // make option.value to input.value & hide option list
                        for (let option of dddlDatalist.options) {
                            option.onclick = function () {
                                // console.log(dddlInput);
                                dddlInput.value = option.value;
                                dddlDatalist.style.display = 'none';
                                // call the first command
                                if ('RepoURL' == DropDownDataLists[i].id) {
                                    sendCommands('start');
                                }
                            };
                        }

                        // hide datalist when mouse is leaving the list
                        dddlDatalist.addEventListener('mouseleave', (e) => {
                            dddlDatalist.style.display = 'none';
                        });

                        dddlInput.oninput = function () {
                            currentFocus = -1;
                            var text = dddlInput.value.toUpperCase();
                            for (let option of dddlDatalist.options) {
                                if (option.value.toUpperCase().indexOf(text) > -1) {
                                    option.style.display = 'block';
                                } else {
                                    option.style.display = 'none';
                                }
                            }
                        };
                        var currentFocus = -1;
                        dddlInput.onkeydown = function (e) {
                            if (e.keyCode == 40) {
                                currentFocus++;
                                addActive(dddlDatalist.options);
                            } else if (e.keyCode == 38) {
                                currentFocus--;
                                addActive(dddlDatalist.options);
                            } else if (e.keyCode == 13) {
                                e.preventDefault();
                                if (currentFocus > -1) {
                                    /*and simulate a click on the "active" item:*/
                                    if (dddlDatalist.options) dddlDatalist.options[currentFocus].click();
                                }
                            }
                        };

                        function addActive(x) {
                            if (!x) return false;
                            removeActive(x);
                            if (currentFocus >= x.length) currentFocus = 0;
                            if (currentFocus < 0) currentFocus = x.length - 1;
                            x[currentFocus].classList.add('active');
                        }

                        function removeActive(x) {
                            for (var i = 0; i < x.length; i++) {
                                x[i].classList.remove('active');
                            }
                        }
                    }); // addEventListener("click")
                } // for DropDownDataLists
                // DATALIST
            }
            DDDL();
        </script>

        <script id="FORMSUBMIT">
            window.addEventListener('load', function () {
                function showData() {
                    let FormName = data.FormMeta.name;
                    let FormElements = document.forms[FormName].elements;
                    // console.log(FormElements);
                    FormValues = {};
                    for (let element of FormElements) {
                        if (element.value && element.name) {
                            // console.log(element.value);
                            FormValues[element.name] = element.value;
                        }
                    }
                    // console.log(FormValues)
                    let values = JSON.stringify(FormValues, undefined, 4);
                    values = values.replaceAll('{', '');
                    values = values.replaceAll('}', '');
                    values = values.replaceAll('"', '');
                    values = values.replaceAll(',', '');
                    values = values.replaceAll('    ', '');
                    // values = '<h3>' + data.FormMeta.name + '-Values</h3>' + values;
                    let FORMVALUES = document.getElementById('FORMVALUES');
                    FORMVALUES.innerHTML = "<fieldset><legend style='font-size: 1.4em'>Form Values</legend><pre>" + values + '</pre></fieldset>';
                    FORMVALUES.style.opacity = 1;
                }

                //
                // CLICKHANDLER for everything?
                document.addEventListener('click', (evt) => {
                    const LEGEND = document.querySelector('#FORMVALUES legend');
                    const FORMVALUES = document.querySelector('#FORMVALUES');
                    let targetElement = evt.target; // clicked element
                    do {
                        if (targetElement == LEGEND) {
                            FORMVALUES.style.opacity = 0;
                            return;
                        }
                        // console.log(targetElement);
                        targetElement = targetElement.parentNode;
                    } while (targetElement);
                    // console.log('outside');
                });

                //
                // KEYHANDLER
                document.onkeydown = function (evt) {
                    evt = evt || window.event;
                    const FORMVALUES = document.querySelector('#FORMVALUES');
                    var isEscape = false;
                    if ('key' in evt) {
                        // console.log(evt);
                        if (evt.key === 'Escape' || evt.key === 'Esc') {
                            FORMVALUES.style.opacity = 0;
                        }
                    }
                };

                // function sendData() {
                //     const XHR = new XMLHttpRequest();
                //     const FD = new FormData(form);
                //     XHR.addEventListener('load', function (event) {
                //         console.log(event.target.responseText);
                //     });
                //     XHR.addEventListener('error', function (event) {
                //         console.log('Oops! Something went wrong.');
                //     });
                //     XHR.open('POST', 'api.php');
                //     console.log(form);
                //     XHR.send(FD);
                // }
                const form = document.getElementById('FORM');
                form.addEventListener('submit', function (event) {
                    event.preventDefault();
                    // sendData();
                    showData();
                });
            });
        </script>

        <script id="JSONDATA">
            const data = {
                FormMeta: {
                    name: 'Testform',
                    ID: 'FORM',
                    method: 'POST',
                    action: '',
                },
                FormData: [
                    {
                        type: 'text',
                        name: 'firstname',
                        titel: 'Firstname',
                        placeholder: 'your Firstname please',
                    },
                    {
                        type: 'inputGroup',
                        items: [
                            {
                                type: 'text',
                                name: 'inputGroup1',
                                titel: 'inputGroup1',
                                placeholder: 'inputGroup1',
                            },
                            {
                                type: 'text',
                                name: 'inputGroup2',
                                titel: 'inputGroup2',
                                placeholder: 'inputGroup2',
                            },
                        ],
                    },
                    {
                        type: 'textarea',
                        name: 'comment',
                        titel: 'Comment',
                        placeholder: 'No newsletter please...',
                    },
                    {
                        type: 'text',
                        name: 'lastname',
                        titel: 'Lastname',
                        placeholder: 'Lour Lastname please',
                    },
                ],
            };
            console.log(data);
            createForm(data);
        </script>
    </body>
</html>
